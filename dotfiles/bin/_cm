#!/bin/bash
#rm -rf $SRCDIR/OMPD
#rm -rf $SRCDIR/llvm 

#git clone git@github.com:clang-ykt/llvm.git $SRCDIR/llvm
#git clone -b open4-proto git@github.com:mcfadden8/openmp.git $SRCDIR/llvm/projects/openmp
#git clone -b accelerator git@github.com:ilagunap/OMPD.git $SRCDIR/OMPD

#rm -rf $INSTALLDIR; mkdir -p $INSTALLDIR
#rm -rf $BUILDDIR/llvm; mkdir -p $BUILDDIR/llvm
rm -rf $BUILDDIR/OMPD; mkdir -p $BUILDDIR/OMPD

#cd $BUILDDIR/llvm
#CMD="cmake \
 #-DLIBOMPTARGET_NVPTX_ENABLE_BCLIB=true\
 #-DCMAKE_INSTALL_PREFIX=$INSTALLDIR\
 #-DCUDA_DEBUG=-G\
 #-DCMAKE_BUILD_TYPE=Debug\
 #-DLIBOMP_OMPD_SUPPORT=TRUE\
 #-DLIBOMP_OMPT_SUPPORT=TRUE\
 #-DLIBOMP_OMP_VERSION=45\
 #-DLIBOMPTARGET_OMPD_SUPPORT=TRUE\
 #-DLIBOMPTARGET_DEP_LIBELF_INCLUDE_DIR=/g/g0/martymcf/.bin/$H/libelf/include\
 #-DLIBOMPTARGET_DEP_LIBELF_LIBRARIES=/g/g0/martymcf/.bin/$H/libelf/lib/libelf.a\
 #-DLIBOMPTARGET_DEP_LIBFFI_LIBRARIES=/g/g0/martymcf/.bin/$H/libffi/lib64/libffi.a\
 #-DLIBOMPTARGET_DEP_LIBFFI_INCLUDE_DIR=/g/g0/martymcf/.bin/$H/libffi/lib/libffi-3.2.1/include\
 #$SRCDIR/llvm"
#echo $CMD
#$CMD
#make -j 16 install

CC=clang
CXX=clang++
cd $BUILDDIR/OMPD
CMD="cmake -DCMAKE_C_COMPILER=$CC -DCMAKE_CXX_COMPILER=$CXX -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=$INSTALLDIR $SRCDIR/OMPD"
#CMD="cmake -DCMAKE_C_COMPILER=$CC -DCMAKE_CXX_COMPILER=$CXX -DCMAKE_INSTALL_PREFIX=$INSTALLDIR $SRCDIR/OMPD"
echo $CMD
$CMD
make -j 16 install
